<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Celuveat Blog</title>
        <link>https://celuveat.github.io/team-blog/back-blog</link>
        <description>Celuveat Blog</description>
        <lastBuildDate>Fri, 21 Jul 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>ko</language>
        <item>
            <title><![CDATA[셀럽잇의 CI/CD]]></title>
            <link>https://celuveat.github.io/team-blog/back-blog/mallang/cicd/cicd</link>
            <guid>https://celuveat.github.io/team-blog/back-blog/mallang/cicd/cicd</guid>
            <pubDate>Fri, 21 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[셀럽잇 팀의 CI/CD를 소개합니다.]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="서론">서론<a href="#서론" class="hash-link" aria-label="서론에 대한 직접 링크" title="서론에 대한 직접 링크">​</a></h2><p>안녕하세요. 셀럽잇의 백엔드 말랑입니다.</p><p>셀럽잇 팀의 CI/CD 아키텍처를 소개해 드리기 위해 찾아왔습니다 😎</p><p>셀럽잇 팀은 주어진 제약 내에서 배포 자동화를 달성하기 위해 많은 고민을 하였고, 최종적으로 다음과 같은 CI/CD 아키텍처를 도입하였습니다.</p><br><p><img loading="lazy" alt="CICD" src="/team-blog/assets/images/cicd-0b8f701c62c4636d0c4cf297fd30b97e.png" width="2738" height="1520" class="img_ev3q"></p><br><p>이러한 과정에서 생겨난 고민들과 발생했던 문제들을 살펴보며 전체적인 구축 과정을 소개해 드리려 합니다.</p><br><br><br><br><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="제약조건과-요구사항">제약조건과 요구사항<a href="#제약조건과-요구사항" class="hash-link" aria-label="제약조건과 요구사항에 대한 직접 링크" title="제약조건과 요구사항에 대한 직접 링크">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="컴퓨팅-파워">컴퓨팅 파워<a href="#컴퓨팅-파워" class="hash-link" aria-label="컴퓨팅 파워에 대한 직접 링크" title="컴퓨팅 파워에 대한 직접 링크">​</a></h3><ul><li>서버 개수: 최대 3대</li><li>서버 사양: 최대 t4g.small</li><li>스토리지: 최대 20GiB</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="요구사항">요구사항<a href="#요구사항" class="hash-link" aria-label="요구사항에 대한 직접 링크" title="요구사항에 대한 직접 링크">​</a></h3><ul><li>개발 서버와 프로덕션 서버의 분리</li></ul><br><br><br><br><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="셀럽잇-팀의-git-브랜치-전략">셀럽잇 팀의 git 브랜치 전략<a href="#셀럽잇-팀의-git-브랜치-전략" class="hash-link" aria-label="셀럽잇 팀의 git 브랜치 전략에 대한 직접 링크" title="셀럽잇 팀의 git 브랜치 전략에 대한 직접 링크">​</a></h2><p>CI/CD 아키텍처에 대한 소개 전에, 원할한 설명을 위하여 저희 팀의 git 브랜치 전략에 대해 우선 소개하도록 하겠습니다.</p><p>셀럽잇 팀은 gitflow 전략을 조금 수정하여 다음과 같이 5개의 브랜치를 사용합니다.</p><ul><li><code>main</code> - 프로덕션용 브랜치</li><li><code>develop-backend</code> - 백엔드의 다음 출시 버전을 개발하는 브랜치</li><li><code>develop-frontend</code>- 프론트엔드의 다음 출시 버전을 개발하는 브랜치</li><li><code>feature</code> - 기능 개발 브랜치</li><li><code>hotfix</code> - main 브랜치에서 발생한 버그를 수정할 때 사용하는 브랜치</li></ul><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="main-브랜치">main 브랜치<a href="#main-브랜치" class="hash-link" aria-label="main 브랜치에 대한 직접 링크" title="main 브랜치에 대한 직접 링크">​</a></h3><p><code>main</code> 브랜치에 존재하는 코드는 실제 서비스될 코드이기 때문에 항상 배포 가능한 상태여야 하며 기능이 완전히 구현된 상태여야 합니다.<br>
<code>main</code> 브랜치는 <code>develop-backend</code> 브랜치와 <code>develop-frontend</code> 브랜치에서 기능들이 완성한 이후 <code>merge</code>됩니다.</p><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="develop-backendfrontend-브랜치">develop-<!-- -->[backend/frontend]<!-- --> 브랜치<a href="#develop-backendfrontend-브랜치" class="hash-link" aria-label="develop-backendfrontend-브랜치에 대한 직접 링크" title="develop-backendfrontend-브랜치에 대한 직접 링크">​</a></h3><p>git flow의 <code>develop</code> 브랜치를 저희의 상황에 맞게 재구성한 브랜치로,
백엔드와 프론트엔드가 각각 서로의 영향을 받지 않고 개발을 이어갈 수 있도록 하기 위하여 위와 같이 구성하였습니다.</p><p>프로젝트에서는 하나의 <code>Repository</code>를 사용하기 때문에, 백엔드와 프론트엔드의 코드 파일 분리도 필요했는데요,
저희는 최상위 directory에서 <code>backend</code> 폴더와 <code>frontend</code> 폴더를 두어 코드를 분리하였습니다.</p><p><code>develop-backend</code> 브랜치에서는 <code>backend</code> 폴더에서만 작업이 이루어지며,
<code>develop-frontend</code> 브랜치에서는 <code>frontend</code> 폴더에서만 작업이 이루어집니다.</p><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="feature-브랜치">feature 브랜치<a href="#feature-브랜치" class="hash-link" aria-label="feature 브랜치에 대한 직접 링크" title="feature 브랜치에 대한 직접 링크">​</a></h3><p><code>feature</code> 브랜치는 기능을 개발하는 브랜치로, 기본적으로 <code>이슈</code>와 1대1 매핑 됩니다.<br>
개발해야 하는 기능들에 대하여 먼저 이슈를 생성하면, 각 이슈별 담당자가 이슈에 대응되는 <code>feature</code> 브랜치를 생성합니다.<br>
기능을 개발되면 <code>feature</code> 브랜치에서 <code>develop</code> 브랜치에 <code>PR</code>을 날립니다.</p><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hotfix-브랜치">hotfix 브랜치<a href="#hotfix-브랜치" class="hash-link" aria-label="hotfix 브랜치에 대한 직접 링크" title="hotfix 브랜치에 대한 직접 링크">​</a></h3><p><code>hotfix</code> 브랜치는 <code>main</code> 브랜치에서 발생한 버그를 급하게 수정해야 하는 경우 사용하는 브랜치입니다.<br>
이때 <code>hotfix</code> 브랜치의 변경 사항은 <code>main</code> 브랜치와 <code>develop</code> 브랜치에 모두 반영됩니다.</p><br><br><br><br><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ci-기술-선택과-구축">CI 기술 선택과 구축<a href="#ci-기술-선택과-구축" class="hash-link" aria-label="CI 기술 선택과 구축에 대한 직접 링크" title="CI 기술 선택과 구축에 대한 직접 링크">​</a></h2><p>저희 팀은 CI를 위해 <code>Github Actions</code>를 사용하기로 결정했습니다.</p><p><code>Github Actions</code>가 <code>Jenkins</code>에 비해 학습 &amp; 적용하기 쉽다고 판단했으며, <code>Github Actions</code> 만으로도 원하는 기능을 모두 사용할 수 있었기에 굳이 <code>Jenkins</code>를 사용할 이유가 없었습니다.</p><p>무엇보다도 <code>Jenkins</code>를 도입한다면 이를 위한 서버를 하나 더 사용해야 하는데, 이렇게 되면 저희에게 주어진 <code>제약조건</code>을 만족하며 프로젝트를 진행하기 어렵다는 판단이 들었습니다.</p><p>그래서 저희는 백엔드와 프론트엔드 모두 CI 기술로써 <code>Github Actions</code>를 도입했으며, 다음과 같이 설정을 진행했습니다.</p><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="백엔드-ci-workflow">백엔드 CI workflow<a href="#백엔드-ci-workflow" class="hash-link" aria-label="백엔드 CI workflow에 대한 직접 링크" title="백엔드 CI workflow에 대한 직접 링크">​</a></h3><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ Celuveat Backend CI ✨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"develop-backend"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"develop-backend"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">checks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull-requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">backend-test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ JDK 17 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">java@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">java-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'17'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">distribution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'temurin'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ Gradlew 권한 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> chmod +x ./gradlew</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.working</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ 테스트 진행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./gradlew test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.working</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ 테스트 결과 Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> EnricoMi/publish</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">unit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">if</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'**/build/test-results/**/*.xml'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ 테스트 실패 Comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mikepenz/action</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">junit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">if</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">report_paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'**/build/test-results/test/TEST-*.xml'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이러한 설정에 대한 자세한 내용은 <a href="https://ttl-blog.tistory.com/1350" target="_blank" rel="noopener noreferrer">말랑이의 블로그</a>를 참고해주세요.</p><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="프론트엔드-ci-workflow">프론트엔드 CI workflow<a href="#프론트엔드-ci-workflow" class="hash-link" aria-label="프론트엔드 CI workflow에 대한 직접 링크" title="프론트엔드 CI workflow에 대한 직접 링크">​</a></h3><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 Celuveat Frontend CI 🍔</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"develop-frontend"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"develop-frontend"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frontend-test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔테스트 딱 대라 💢👊</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">node-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'18.16.1'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 yarn install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yarn install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.working</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 eslint 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yarn lint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.working</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 React 프로젝트 빌드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">working-directory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.working</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위와 같이 백엔드와 프론트엔드의 CI workflow를 작성하여 develop-backend &amp; develop-frontend 브랜치에 PR이 발샐할 때마다 테스트를 수행하도록 설정했습니다.</p><br><br><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="통합main-ci-workflow">통합(main) CI workflow<a href="#통합main-ci-workflow" class="hash-link" aria-label="통합(main) CI workflow에 대한 직접 링크" title="통합(main) CI workflow에 대한 직접 링크">​</a></h3><p><strong>(아직 작성하지 않았습니다 😎)</strong></p><br><br><br><br><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cd-기술-선택과-구축">CD 기술 선택과 구축<a href="#cd-기술-선택과-구축" class="hash-link" aria-label="CD 기술 선택과 구축에 대한 직접 링크" title="CD 기술 선택과 구축에 대한 직접 링크">​</a></h2><p>처음에는 CD를 위한 기술로써 <code>Jenkins</code>를 사용하려 했습니다.
저를 포함한 몇몇 팀원들이 이미 경험해 본 기술이었기 때문에, 적용하는데 큰 어려움이 없을 것이라 판단했었습니다.</p><p>그런데 위에서 언급한 <code>제약조건</code>을 고려한 결과, 최종적으로 <code>Jenkins</code> 대신 <code>Github Actions</code>의 <code>self-hosted runners</code>를 사용하기로 결정하였습니다.</p><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jenkins-대신-github-actions를-사용한-이유">Jenkins 대신 Github Actions를 사용한 이유<a href="#jenkins-대신-github-actions를-사용한-이유" class="hash-link" aria-label="Jenkins 대신 Github Actions를 사용한 이유에 대한 직접 링크" title="Jenkins 대신 Github Actions를 사용한 이유에 대한 직접 링크">​</a></h3><p>제약조건 속에는 다음과 같은 항목이 존재했습니다.</p><ul><li>서버 개수: 최대 3대</li><li>서버 사양: 최대 t4g.small</li></ul><p>개발 서버와 프로덕션 서버를 분리하기 위한 요구사항을 고려했을 때, 우선 이들을 위한 서버가 최소한 2대는 할당되어야 했습니다.<br>
(개발 서버 1대, 프로덕션 서버 1대)</p><p>또한 데이터베이스를 사용하여야 했기 때문에, DB 전용 서버가 한 대 더 필요한 상황이었습니다.<br>
개발 서버에서 데이터베이스를 설치하여 사용하는 방법도 있었지만, 보안 &amp; 성능상의 문제로 인해 이는 좋은 방법이 아니라 판단하였고, 데이터베이스용 서버를 따로 두기로 결정하였습니다.</p><p>최종적으로 개발, 프로덕션, 데이터베이스 서버를 각각 분리하여 사용하기로 결정했습니다.</p><p>이러한 상황이었기에 CD를 위해서 추가로 서버를 사용할 수 없었고, 결국 기존 서버에 추가하는 식으로 구성하여야 했습니다.</p><p>이때 각 서버의 사양인 <code>t4g.small</code>의 스펙은 다음과 같습니다</p><ul><li>vCPU: 2</li><li>RAM: 2 GiB</li></ul><p>RAM이 2GB밖에 안되기 때문에 메모리를 최대한 적게 사용하는 도구를 사용하여야 했으며, 이를 위해 <code>Jenkins</code>와 <code>Github Actions</code>의 <code>self-hosted runners</code>를 비교했습니다.</p><p>비교 결과는 <code>Github Actions</code>의 <code>self-hosted runners</code>가 <code>Jenkins</code>보다 메모리 사용량이 훨씬 낮았고, 따라서 <code>Github Actions</code>를 통해 CD를 구축하기로 결정했습니다.</p><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="참고---메모리-사용량-비교">참고 - 메모리 사용량 비교<a href="#참고---메모리-사용량-비교" class="hash-link" aria-label="참고 - 메모리 사용량 비교에 대한 직접 링크" title="참고 - 메모리 사용량 비교에 대한 직접 링크">​</a></h3><p>비교 시 공통 사항은 다음과 같습니다.</p><ul><li>Swap 메모리 1.5 GB 할당</li><li>java 17 버전 설치</li></ul><br><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="기본적인-서버의-메모리-사용량">기본적인 서버의 메모리 사용량<a href="#기본적인-서버의-메모리-사용량" class="hash-link" aria-label="기본적인 서버의 메모리 사용량에 대한 직접 링크" title="기본적인 서버의 메모리 사용량에 대한 직접 링크">​</a></h4><p>자바만을 깔아둔 서버의 메모리 사용량은 다음과 같습니다.
<img loading="lazy" alt="basic-java" src="/team-blog/assets/images/자바설치기본상태-33b84a983f038a4a89c441f175f2acf5.png" width="1332" height="166" class="img_ev3q"></p><br><br><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="github-actions-self-hosted-runner">Github Actions self-hosted runner<a href="#github-actions-self-hosted-runner" class="hash-link" aria-label="Github Actions self-hosted runner에 대한 직접 링크" title="Github Actions self-hosted runner에 대한 직접 링크">​</a></h4><p>단순 Runner 설치 후 실행 상태입니다.
<img loading="lazy" alt="actions-basic" src="/team-blog/assets/images/깃헙액션기본-976e5e5011d5d0d028955f1bf4455323.png" width="1320" height="424" class="img_ev3q"></p><br><br><p>웹훅으로 runner가 동작하여 bootJar을 실행할 때의 최대 메모리 사용량입니다.
<img loading="lazy" alt="actions-max" src="/team-blog/assets/images/깃헙액션최대-a92ed23a5c1c9a7af66430a03bff0e53.png" width="1324" height="124" class="img_ev3q"></p><br><br><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jenkins">Jenkins<a href="#jenkins" class="hash-link" aria-label="Jenkins에 대한 직접 링크" title="Jenkins에 대한 직접 링크">​</a></h4><p>Jenkins 설치 후 단순 실행 상태입니다.
<img loading="lazy" alt="jenkins-basic" src="/team-blog/assets/images/jenkins기본-039744d2e2cf359b43a60cd14b2db878.png" width="1302" height="276" class="img_ev3q"></p><p>웹훅으로 젠킨스가 동작하여 bootJar을 실행할 때의 최대 메모리 사용량입니다.
<img loading="lazy" alt="jenkins-max" src="/team-blog/assets/images/jenkins최대-691b956046a510c315242fddfb619972.png" width="1336" height="126" class="img_ev3q"></p><br><br><p>이렇듯 간단한 비교를 통해서도 <code>Jenkins</code>가 <code>Github Actions</code> 의 <code>self-hosted runners</code>보다 많은 메모리를 필요로 하는 것을 알 수 있었습니다.</p><p>최종적으로 저희 팀은 메모리 사용량도 적고, 적용하기도 쉬운(?) <code>Github Actions self-hosted runners</code>를 사용하기로 했습니다.</p><br><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="백엔드-cd-workflow">백엔드 CD workflow<a href="#백엔드-cd-workflow" class="hash-link" aria-label="백엔드 CD workflow에 대한 직접 링크" title="백엔드 CD workflow에 대한 직접 링크">​</a></h3><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ Celuveat backend DEV CD ✨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> develop</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'backend/**'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy-backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">hosted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ✨ Run Backend Deploy Script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          cd ~</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo ./deploy-backend.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="백엔드-배포-스크립트">백엔드 배포 스크립트<a href="#백엔드-배포-스크립트" class="hash-link" aria-label="백엔드 배포 스크립트에 대한 직접 링크" title="백엔드 배포 스크립트에 대한 직접 링크">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">echo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">command</span><span class="token plain"> </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">'+%Y-%m-%d %H:%M:%S'</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c"> - </span><span class="token string variable" style="color:#36acaa">$*</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PROJECT_PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/home/ubuntu/2023-celuveat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PROJECT_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">BUILD_PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">build/libs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">JAR_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">celuveat-0.0.1-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c"> ✨   [</span><span class="token string variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token string" style="color:#e3116c">] 경로로 이동합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   develop-backend 브랜치로 이동합니다!</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> switch develop-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c"> ✨   [</span><span class="token string variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token string" style="color:#e3116c">] 경로로 이동합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> ./</span><span class="token variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨    최신 코드를 PULL 합니다!</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   프로젝트를 새롭게 빌드합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./gradlew clean build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   [</span><span class="token string variable" style="color:#36acaa">$PORT</span><span class="token string" style="color:#e3116c">] 번 포트를 사용하는 애플리케이션을 찾습니다...</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PID</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">lsof</span><span class="token variable" style="color:#36acaa"> -i :$PORT -t</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> -z </span><span class="token variable" style="color:#36acaa">$PID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" 🎉   실행중인 애플리케이션이 없어서 곧바로 실행합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ❌   실행중인 애플리케이션이 있어서 이를 종료합니다. [PID = </span><span class="token string variable" style="color:#36acaa">$PID</span><span class="token string" style="color:#e3116c">]</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">kill</span><span class="token plain"> -15 </span><span class="token variable" style="color:#36acaa">$PID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   애플리케이션을 실행하는데 필요한 환경변수를 세팅합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">SPRING_PROFILES_ACTIVE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"dev"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">DB_DRIVER_CLASS_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"com.mysql.cj.jdbc.Driver"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">DB_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"jdbc:mysql://[비밀입니당]"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">DB_USERNAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"비밀입니당"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">DB_PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"비밀입니당"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">CORS_ALLOW_ORIGINS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"http://127.0.0.1:3000"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" 🎉   애플리케이션 실행합니다~ 🎉</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">current_date</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">date</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">'+%Y-%m-%dT%H-%M'</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">BACKEND_LOG_FILE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"backend-log-</span><span class="token string variable" style="color:#36acaa">$current_date</span><span class="token string" style="color:#e3116c">.log"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nohup</span><span class="token plain"> java -jar </span><span class="token variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$BUILD_PATH</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$JAR_NAME</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/log/backend/</span><span class="token variable" style="color:#36acaa">$BACKEND_LOG_FILE</span><span class="token plain"> </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>조금 더 고도화가 필요하지만, 우선은 간단하게만 작성했습니다.</p><br><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="프론트엔드-cd-workflow">프론트엔드 CD workflow<a href="#프론트엔드-cd-workflow" class="hash-link" aria-label="프론트엔드 CD workflow에 대한 직접 링크" title="프론트엔드 CD workflow에 대한 직접 링크">​</a></h3><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 Celuveat frontend DEV CD 🍔</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> develop</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'frontend/**'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy-frontend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">hosted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 .env 파일 세팅</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          touch ~/frontend-env/.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo KAKAO_MAP_API_KEY=${{ secrets.KAKAO_MAP_API_KEY }} &gt;&gt; ~/frontend-env/.env</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 🍔 Run Frontend Deploy Script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          cd ~</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo ./deploy-frontend.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><br><br><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="프론트엔드-배포-스크립트">프론트엔드 배포 스크립트<a href="#프론트엔드-배포-스크립트" class="hash-link" aria-label="프론트엔드 배포 스크립트에 대한 직접 링크" title="프론트엔드 배포 스크립트에 대한 직접 링크">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">echo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">command</span><span class="token plain"> </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">'+%Y-%m-%d %H:%M:%S'</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c"> - </span><span class="token string variable" style="color:#36acaa">$*</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PROJECT_PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/home/ubuntu/2023-celuveat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PROJECT_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c"> ✨   [</span><span class="token string variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token string" style="color:#e3116c">] 경로로 이동합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   develop-frontend 브랜치로 이동합니다!</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> switch develop-frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c"> ✨   [</span><span class="token string variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token string" style="color:#e3116c">] 경로로 이동합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> ./</span><span class="token variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨    최신 코드를 PULL 합니다!</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   yarn install &amp; yarn build 로 빌드합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   [</span><span class="token string variable" style="color:#36acaa">$PORT</span><span class="token string" style="color:#e3116c">] 번 포트를 사용하는 애플리케이션을 찾습니다...</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PID</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">lsof</span><span class="token variable" style="color:#36acaa"> -i :$PORT -t</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> -z </span><span class="token variable" style="color:#36acaa">$PID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" 🎉   실행중인 애플리케이션이 없어서 곧바로 실행합니다.</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ❌   실행중인 애플리케이션이 있어서 이를 종료합니다. [PID = </span><span class="token string variable" style="color:#36acaa">$PID</span><span class="token string" style="color:#e3116c">]</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">kill</span><span class="token plain"> -15 </span><span class="token variable" style="color:#36acaa">$PID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   .env 파일 복사</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /home/ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> /home/ubuntu/frontend-env/.env </span><span class="token variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$PROJECT_PATH</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$PROJECT_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">pwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" ✨   애플리케이션 실행</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">current_date</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">date</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">'+%Y-%m-%dT%H-%M'</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">FRONTEND_LOG_FILE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"frontend-log-</span><span class="token string variable" style="color:#36acaa">$current_date</span><span class="token string" style="color:#e3116c">.log"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nohup</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> start -- --port </span><span class="token variable" style="color:#36acaa">$PORT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/log/frontend/</span><span class="token variable" style="color:#36acaa">$FRONTEND_LOG_FILE</span><span class="token plain"> </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><br><br><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="마무리">마무리<a href="#마무리" class="hash-link" aria-label="마무리에 대한 직접 링크" title="마무리에 대한 직접 링크">​</a></h2><p>이렇게 해서 셀럽잇 팀의 CI/CD 아키텍처를 살펴보았습니다.
이것보다 더 좋은 대안이 있을 수도 있겠지만, 빠르게 개발을 진행해야 하는 상황과,
팀원 대부분이 지식이 별로 없는 상태에서 적용하기 수월한 구조를 찾다 보니 이러한 구조로 귀결된 것 같습니다.</p><p>부족한 내용은 차근차근 추가하도록 하겠습니다.
읽어주셔서 감사합니다 😊</p><br><br><br>]]></content:encoded>
            <author>huipulci1@naver.com (donghun Shin)</author>
            <category>회고</category>
            <category>우아한테크코스</category>
            <category>글쓰기</category>
        </item>
    </channel>
</rss>